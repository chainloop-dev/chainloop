# Contract for codeql workflow
apiVersion: chainloop.dev/v1
kind: Contract
metadata:
  name: chainloop-vault-codeql
  description: Contract for Vault CodeQL workflow
spec:
  runner:
    type: GITHUB_ACTION
  materials:
    - type: SARIF
      name: sarif-results
      output: true
  policies:
    attestation:
      - ref: source-commit
        with:
          check_signature: yes
          check_author_verified: yes
        requirements:
          - chainloop-best-practices/commit-signed
  policyGroups:
    - ref: slsa-checks
      with:
        runner: GITHUB_ACTION
    - ref: sast
